
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width-device-width, initial-scale=1.0">
  <title>แบบฟอร์มตรวจเช็คระบบไฟฟ้า</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.9)), url('https://images.unsplash.com/photo-1603791440384-56cd371ee9a7?auto=format&fit=crop&w=1350&q=80');
      background-size: cover;
      background-position: center;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #ff6600;
      text-align: center;
      margin-bottom: 30px;
    }
    form {
      background-color: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 10px;
      max-width: 700px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    input[type="text"], input[type="file"], select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #ff6600;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background-color: #cc5200;
    }
  </style>
</head>
<body>
  <h1>IT Maintennance<br>PROFESSIONAL ELETRICIAN</br></h1>
  <form>
    <label>สถานที่</label>
    <select name="location">
      <option value="">-- เลือกสถานที่ --</option>
      <option value="1.บ้านพักพนักงาน">1.บ้านพักพนักงาน</option>
<option value="2.เสาทางเข้าโรงงาน">2.เสาทางเข้าโรงงาน</option>
<option value="3.ตู้ CCTV โรงรถ">3.ตู้ CCTV โรงรถ</option>
<option value="4.ตู้ CCTV ข้างป้อมรปภ.2">4.ตู้ CCTV ข้างป้อมรปภ.2</option>
<option value="5.ข้างในป้อมรปภ.2">5.ข้างในป้อมรปภ.2</option>
<option value="6.ตู้ CCTV หมักส่าฝั่งทางเข้าโรงงาน">6.ตู้ CCTV หมักส่าฝั่งทางเข้าโรงงาน</option>
<option value="7.ตู้ CCTV ฝั่งติดกลั่น">7.ตู้ CCTV ฝั่งติดกลั่น</option>
<option value="8.ตู้ CCTV Ro">8.ตู้ CCTV Ro</option>
<option value="9.ตู้ CCTV กลั่น">9.ตู้ CCTV กลั่น</option>
<option value="10.แพลนปรับสภาพน้ำ">10.แพลนปรับสภาพน้ำ</option>
<option value="11.ต้นกำลัง">11.ต้นกำลัง</option>
<option value="12.CCTV Server room">12.CCTV Server room</option>
<option value="13.CCTV ห้องหัวหน้าบรรจุ">13.CCTV ห้องหัวหน้าบรรจุ</option>
<option value="14.CCTV ตู้หน้าลิฟฟ์บรรจุ">14.CCTV ตู้หน้าลิฟฟ์บรรจุ</option>
<option value="15.ท่าน้ำปรับสภาพน้ำ">15.ท่าน้ำปรับสภาพน้ำ</option>
<option value="16.ท่าน้ำตรงตู้ไฟใหญ่">16.ท่าน้ำตรงตู้ไฟใหญ่</option>
<option value="17.TBL ตู้ CCTV">17.TBL ตู้ CCTV</option>
<option value="18.สิ่งแวดล้อมตู้หน้าแผนก">18.สิ่งแวดล้อมตู้หน้าแผนก</option>
<option value="19.ตู้อาคารพักขยะ">19.ตู้อาคารพักขยะ</option>
<option value="20.สิ่งแวดล้อมตู้กลางบ่อ">20.สิ่งแวดล้อมตู้กลางบ่อ</option>
<option value="21.ปรุงสุราอาคาร 1">21.ปรุงสุราอาคาร 1</option>
<option value="22.ปรุงสุราอาคาร 2">22.ปรุงสุราอาคาร 2</option>
<option value="23.โรงบรมบริเวณหัวโค้งไปศาล">23.โรงบรมบริเวณหัวโค้งไปศาล</option>
<option value="24.โรงบรมบริเวณหัวโค้งไปศาล2(ป้อมยาม)">24.โรงบรมบริเวณหัวโค้งไปศาล2(ป้อมยาม)</option>
<option value="25.HOM internet">25.HOM internet</option>
<option value="26.พัสดุ internet">26.พัสดุ internet</option>
<option value="27.โรงงานอาหาร  internet">27.โรงงานอาหาร  internet</option>
<option value="28.ซ่อมบำรุง  internet">28.ซ่อมบำรุง  internet</option>
<option value="29.อาคารวิทยาศาสตร์  internet">29.อาคารวิทยาศาสตร์  internet</option>
<option value="30.บรรจุ  internet">30.บรรจุ  internet</option>
<option value="31.Serverroom  internet">31.Serverroom  internet</option>
<option value="32.กลั่น  internet">32.กลั่น  internet</option>
<option value="33.บักพักเรืองรับรอง  internet">33.บักพักเรืองรับรอง  internet</option>
<option value="34.HOM เครื่องเสียงชั่น 2">34.HOM เครื่องเสียงชั่น 2</option>
<option value="35.HOM เครื่องเสียงชั่น 1">35.HOM เครื่องเสียงชั่น 1</option>
<option value="36.ตึกอำนวยการ ประชุม1 เครื่องเสียง ">36.ตึกอำนวยการ ประชุม1 เครื่องเสียง </option>
<option value="37.ตึกอำนวยการ ประชุม4 เครือ่งเสียง ">37.ตึกอำนวยการ ประชุม4 เครือ่งเสียง </option>
    </select>

        <label>วัน</label>
    <select name="day">
      <option value="">--เลือกวัน--</option>
      <option value="">จันทร์</option>
      <option value="">อังคาร</option>
      <option value="">พุธ</option>
      <option value="">พฤหัสบดี</option>
      <option value="">ศุกร์</option>
      <option value="">เสาร์</option>
      <option value="">อาทิตย์</option>
    </select>

    <label>วันที่</label>
    <select name="วันที่">
      <option value="">--วันที่--</option>
      <option value="">1</option>
      <option value="">2</option>
      <option value="">3</option>
      <option value="">4</option>
      <option value="">5</option>
      <option value="">6</option>
      <option value="">7</option>
      <option value="">8</option>
      <option value="">9</option>
      <option value="">10</option>
      <option value="">11</option>
      <option value="">12</option>
      <option value="">13</option>
      <option value="">14</option>
      <option value="">15</option>
      <option value="">16</option>
      <option value="">17</option>
      <option value="">18</option>
      <option value="">19</option>
      <option value="">20</option>
      <option value="">21</option>
      <option value="">22</option>
      <option value="">23</option>
      <option value="">24</option>
      <option value="">25</option>
      <option value="">26</option>
      <option value="">27</option>
      <option value="">28</option>
      <option value="">29</option>
      <option value="">30</option>
      <option value="">31</option>
    </select>
    
    <label>เดือน</label>
    <select name="month">
      <option value="">-- เลือกเดือน --</option>
      <option value="มกราคม">มกราคม</option>
<option value="กุมภาพันธ์">กุมภาพันธ์</option>
<option value="มีนาคม">มีนาคม</option>
<option value="เมษายน">เมษายน</option>
<option value="พฤษภาคม">พฤษภาคม</option>
<option value="มิถุนายน">มิถุนายน</option>
<option value="กรกฎาคม">กรกฎาคม</option>
<option value="สิงหาคม">สิงหาคม</option>
<option value="กันยายน">กันยายน</option>
<option value="ตุลาคม">ตุลาคม</option>
<option value="พฤศจิกายน">พฤศจิกายน</option>
<option value="ธันวาคม">ธันวาคม</option>
    </select>


    <label>วิธีการตรวจ + อุปกรณ์ที่ใช้</label>
    <select name="Infrared Thermometer">
      <option value="">--วิธีการตรวจ + อุปกรณ์ที่ใช้--</option>
      <option value="">ตรวจเช็คทางกายภาพ + Infrared Thermometer </option> 
      <option value="">ตรวจเช็คทางกายภาพ</option>
      <option value="">อื่นๆ</option>
    </select>

    <input type="text" name="method">

    <label>ผลการตรวจ</label>
    <select name="ผลการตรวจ">
      <option value="">--เลือกผลการตรวจ--</option>
      <option value="">สายปกติ </option>
      <option value="">สายผิดปกติ </option>
      </select>
    <input type="text" name="result">

    <label>อุณหภูมิสาย (°C)</label>
    <select name="อุณหภูมิสาย">
      <option value="">--เลือกอุณหภูมิ--</option>
      <option value="">ปกติ </option>
      <option value="">ร้อน </option>
      <option value="">ร้อนมาก </option>
      <option value="">เย็น </option>
      </select>
    <input type="text" name="wire_temp">

    <label>อุปกรณ์ต่อพ่วง,ปลั๊กไฟ</label>
    <select name="อุณหภูมิอุปกรณ์ต่อพ่วง,ปลั๊กไฟ">
      <option value="">--เลือกคุณภาพอุปกรณ์ต่อพ่วง--</option>
      <option value="">ได้มาตรฐาน</option>
      <option value="">ไม่ได้มาตรฐาน</option>
      <option value="">ควรเปลียน</option>
      </select>
    <input type="text" name="peripheral">

    <label>อุณหภูมิอุปกรณ์ต่อพ่วง(°C)</label>
    <input type="text" name="peripheral_temp">

    <label>คำแนะนำ</label>
    <input type="text" name="recommendation">

    <label>ผลการตรวจ UPS</label>
    <select name="ups_result">
      <option value="">--เลือก--</option>
      <option value="">มี,ใช้งานได้</option>
      <option value="">มี,เสีย</option>
      <option value="">ไม่มี</option>
      <option value="">คำเเนะนำ,หมายเหตุ</option>
      </select>
    <input type="text" name="ups_result">

    <label>รูปถ่ายการตรวจ:</label>
    <input type="file" name="inspection_photos[]" accept="image/*" multiple>

    <label>Speedtest Internet</label>
    <input type="file" name="speedtest_photo" accept="image/*">

    <label>Status</label>
    <select name="ups_result">
      <option value="">--สถานะการตรวจเช็ค--</option>
      <option value="">--ตรวจเเล้ว--</option>
      <option value="">--ยังไม่มีการตรวจเช็ค--</option>
    </select>
    <input type="text" name="status">

    <button type="submit">บันทึกข้อมูล</button>
  </form>
  
</body>
</html>

  
<title>บันทึกการซื้อของ</title>
</head>
<body>
  <h2>กรอกข้อมูลสิ่งของ</h2>
  <form id="itemForm">
    <label>ชื่อสิ่งของ: <input type="text" id="itemName" required></label><br><br>
    <label>วันที่ซื้อ: <input type="date" id="purchaseDate" required></label><br><br>
    <button type="submit">คำนวณ</button>
  </form>

  <h3 id="result"></h3>

  <script>
    document.getElementById('itemForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const name = document.getElementById('itemName').value;
      const purchaseDate = new Date(document.getElementById('purchaseDate').value);
      const today = new Date();

      let years = today.getFullYear() - purchaseDate.getFullYear();
      let months = today.getMonth() - purchaseDate.getMonth();
      let days = today.getDate() - purchaseDate.getDate();

      if (days < 0) {
        months--;
        const prevMonth = new Date(today.getFullYear(), today.getMonth(), 0);
        days += prevMonth.getDate();
      }

      if (months < 0) {
        years--;
        months += 12;
      }

      document.getElementById('result').innerText = 
        `สิ่งของ "${name}" ใช้งานมาแล้ว ${years} ปี ${months} เดือน ${days} วัน`;
    });
  </script>
  
  
<head>
  <meta charset="UTF-8">
  <title>แดชบอร์ดแผนการตรวจสายไฟ</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background-color: #f9f9f9;
    }
    .table-container {
      overflow-x: auto;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #fff;
      padding: 10px;
    }
    table {
      border-collapse: collapse;
      font-size: 12px;
      min-width: 900px;
      width: 100%;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px 8px;
      text-align: center;
      white-space: nowrap;
    }
    th {
      background-color: #f0f0f0;
      position: sticky;
      top: 0;
      z-index: 1;
    }
    .checked {
      background-color: #c8f7c5;
      font-weight: bold;
      color: #2b8a3e;
    }
    h2 {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <h2>แดชบอร์ดแผนการตรวจสายไฟ</h2>
  <div class="table-container">
    <table id="inspectionTable">
      <!-- ตารางจะถูกสร้างโดย JavaScript -->
    </table>
  </div>

  <script>
    async function loadData() {
      const response = await fetch('inspection_plan.json');
      const data = await response.json();

      // ดึงชื่อเดือนทั้งหมดจากข้อมูล
      const months = [
        'มกราคม', 'กุมภาพันธ์', 'มีนาคม', 'เมษายน',
         'พฤษภาคม', 'มิถุนายน', 'กรกฎาคม', 'สิงหาคม',
          'กันยายน', 'ตุลาคม', 'พฤศจิกายน', 'ธันวาคม'
];
      const weeks = [1, 2, 3, 4];

      let html = '<thead><tr><th rowspan="2">สถานที่</th>';

      // แถวที่ 1: เดือน (รวม 4 คอลัมน์ของแต่ละเดือน)
      months.forEach(month => {
        html += `<th colspan="4">${month}</th>`;
      });
      html += '</tr><tr>';

      // แถวที่ 2: สัปดาห์
      months.forEach(() => {
        weeks.forEach(week => {
          html += `<th>สัปดาห์ ${week}</th>`;
        });
      });
      html += '</tr></thead><tbody>';

      // ข้อมูลแต่ละแถว
      data.forEach(item => {
        html += `<tr><td>${item.location}</td>`;
        months.forEach(month => {
          weeks.forEach(week => {
            const cell = item.inspections.find(i => i.month === month && i.week === week);
            const status = cell ? cell.status : '';
            const isChecked = status === '✓' || status.toLowerCase() === 'x';
            html += `<td class="${isChecked ? 'checked' : ''}">${status}</td>`;
          });
        });
        html += '</tr>';
      });

      html += '</tbody>';
      document.getElementById('inspectionTable').innerHTML = html;
    }

    loadData();
  </script>


<script>
document.addEventListener('DOMContentLoaded', () => {
  const saveButton = document.querySelector('button'); // ปุ่มบันทึกข้อมูล

  saveButton.addEventListener('click', async () => {
    // ดึงค่าจากฟอร์ม
    const location = document.querySelector('select[name="location"]').value;
    const month = document.querySelector('select[name="month"]').value;
    const week = parseInt(document.querySelector('select[name="week"]').value);
    const status = "✓"; // กำหนดว่าตรวจแล้ว

    // โหลดข้อมูล JSON เดิม
    const response = await fetch('inspection_plan.json');
    const data = await response.json();

    // อัปเดตสถานะใน JSON
    data.forEach(item => {
      if (item.location === location) {
        item.inspections.forEach(i => {
          if (i.month === month && i.week === week) {
            i.status = status;
          }
        });
      }
    });

    // แปลงข้อมูลกลับเป็น JSON string
    const updatedJson = JSON.stringify(data, null, 2);

    // สร้างไฟล์ใหม่ให้ดาวน์โหลด (ถ้าไม่มี backend)
    const blob = new Blob([updatedJson], { type: 'application/json' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'inspection_plan.json';
    link.click();

    alert('บันทึกข้อมูลเรียบร้อยแล้ว');
  });
});
</script>

</body>
</html>
